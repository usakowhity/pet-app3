/* --- ベース設定 --- */
body, html {
    margin: 0; padding: 0;
    width: 100%; height: 100%;
    overflow: hidden; /* スクロール禁止 */
    background-color: #f0f4f8; /* 優しい空色背景 */
    font-family: "Helvetica Neue", Arial, sans-serif;
    touch-action: manipulation; /* ダブルタップ拡大防止 */
}

#app {
    position: relative;
    width: 100%; height: 100%;
    display: flex; flex-direction: column;
    justify-content: center; align-items: center;
}

/* --- ペット表示エリア (3Dパースペクティブ付き) --- */
#pet-container {
    position: relative;
    width: 95vw; height: 95vw; /* ほぼ正方形 */
    max-width: 500px; max-height: 500px;
    display: flex; justify-content: center; align-items: center;
    perspective: 1000px; 
}

/* 画像と動画を同じ位置に重ねるクラス */
.pet-media {
    position: absolute;
    width: 100%; height: 100%;
    object-fit: contain; /* アスペクト比維持 */
    transition: transform 0.3s ease;
    pointer-events: auto; /* タッチ検知有効 */
}

/* 非表示用ユーティリティ */
.hidden {
    display: none !important;
}

/* --- アニメーション --- */

/* p2: 喜び・甘え (ズーム＆すり寄り) */
.happy-p2-animation {
    animation: nuzzleAndZoom 1.5s infinite ease-in-out;
    filter: drop-shadow(0 0 15px rgba(255, 182, 193, 0.7)); /* ピンクの光 */
}

@keyframes nuzzleAndZoom {
    0% { transform: scale(1.0) translateY(0) rotate(0); }
    25% { transform: scale(1.15) translateY(10px) rotate(-3deg); } /* グッと近づく */
    50% { transform: scale(1.2) translateY(5px) rotate(0); }       /* 最接近 */
    75% { transform: scale(1.15) translateY(10px) rotate(3deg); }  /* 反対側へ */
    100% { transform: scale(1.0) translateY(0) rotate(0); }
}

/* p5/p6: 食事などの揺れ */
.eating-rock { animation: rock 1s infinite alternate ease-in-out; }
@keyframes rock { from { transform: rotate(-2deg); } to { transform: rotate(2deg); } }

/* p7: トイレの微振動 */
.toilet-squat { animation: shiver 0.2s infinite alternate; }
@keyframes shiver { from { transform: translateY(2px); } to { transform: translateY(4px); } }

/* --- UIパーツ --- */
#message-box {
    position: absolute; bottom: 12%;
    background: rgba(255, 255, 255, 0.9);
    padding: 12px 24px; border-radius: 30px;
    box-shadow: 0 4px 15px rgba(0,0,0,0.1);
    font-weight: bold; color: #555;
    pointer-events: none;
    max-width: 85%;
    text-align: center;
}

#start-overlay {
    position: fixed; top: 0; left: 0;
    width: 100%; height: 100%;
    background: rgba(255, 255, 255, 0.98);
    display: flex; justify-content: center; align-items: center;
    z-index: 1000; cursor: pointer;
    flex-direction: column; text-align: center;
}
.start-msg h2 { margin: 0 0 10px; color: #333; }
.start-msg small { color: #888; }

#settings-btn {
    position: absolute; top: 20px; right: 20px;
    font-size: 28px; background: none; border: none; 
    cursor: pointer; z-index: 100;
}

/* --- 設定モーダル (拡張UI) --- */
#settings-modal {
    position: fixed; top: 0; left: 0; width: 100%; height: 100%;
    background: rgba(0,0,0,0.6); z-index: 200;
    display: flex; justify-content: center; align-items: center;
}

.modal-content {
    background: white; padding: 20px; 
    width: 85%; max-width: 320px;
    max-height: 85vh; overflow-y: auto; /* 縦長になってもスクロール可能に */
    border-radius: 15px; 
    text-align: left;
    box-shadow: 0 10px 25px rgba(0,0,0,0.2);
}

.modal-content h3 { margin-top: 0; text-align: center; color: #333; }
.modal-content h4 { margin: 15px 0 5px; color: #555; font-size: 0.95em; }
.modal-content hr { border: 0; border-top: 1px solid #eee; margin: 15px 0; }

/* ペットリスト */
.pet-option {
    padding: 10px; border-bottom: 1px solid #f0f0f0; cursor: pointer;
    font-size: 16px; display: flex; justify-content: space-between;
}
.pet-option:hover { background: #f9fcff; }
.selected-pet {
    background-color: #e6f7ff;
    border-left: 4px solid #007bff;
    font-weight: bold;
}

/* 入力エリア */
.edit-section {
    background: #f8f9fa;
    padding: 10px;
    border-radius: 8px;
    margin-bottom: 10px;
}
.edit-section label {
    font-size: 12px; color: #666; display: block; margin-bottom: 4px;
}

.input-group {
    display: flex; gap: 5px; margin-bottom: 8px;
}
.input-group input {
    flex: 1; padding: 6px;
    border: 1px solid #ddd; border-radius: 4px;
    font-size: 14px;
}

/* ボタン類 */
button.btn-change { background: #007bff; color: white; border: none; border-radius: 4px; padding: 0 10px; }
button.btn-add { background: #28a745; color: white; border: none; border-radius: 4px; padding: 0 10px; }
button.close-btn {
    width: 100%; padding: 10px; margin-top: 10px;
    background: #6c757d; color: white; border: none; border-radius: 8px;
    font-size: 16px;
}

/* キーワードタグ */
#keyword-list {
    display: flex; flex-wrap: wrap; gap: 4px;
}
.keyword-tag {
    background: #fff; border: 1px solid #ddd;
    padding: 2px 8px; border-radius: 12px;
    font-size: 12px; color: #333;
    display: inline-flex; align-items: center;
}
.keyword-tag b {
    margin-left: 6px; color: #dc3545; cursor: pointer; font-weight: bold;
}